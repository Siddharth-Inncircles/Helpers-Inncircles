<div class="custom-stepper-container">
  <!-- Step labels (left side) -->
  <div class="steps-list">
    <div class="step-item" *ngFor="let step of steps; let i = index" [class.active]="i === currentStep"
      (click)="goToStep(i)">
      <div class="step-number">{{ i + 1 }}</div>
      <div class="step-label">{{ step.label }}</div>
    </div>
  </div>

  <!-- Step content (right side) -->
  <div class="step-content">
    <ng-container [ngSwitch]="currentStep">

      <!-- Step 1 -->
      <form *ngSwitchCase="0" [formGroup]="firstFormGroup">

        <label class="custom-file-upload-img">
          <mat-icon class="profile-upload-icon-img">cloud_upload</mat-icon>
          <p>Upload Photo</p>
          <input type="file" accept="image/*" (change)="onProfileImageSelected($event)" />
        </label>
        <p style="color: grey; margin-bottom: 30px;">Upload photo (.png, .jpeg) Max size: 5MB</p>


        <h3>Type of service <span class="required">*</span> </h3>
        <app-custom-select formControlName="type" [options]="[
                    {value:'Nurse', label:'Nurse'},
                    {value:'Driver', label:'Driver'},
                    {value:'Newspaper', label:'Newspaper'},
                    {value:'Maid', label:'Maid'},
                    {value:'Plumber', label:'Plumber'},
                    {value:'Cook', label:'Cook'},
                ]" placeholder="Select type of Work" />
        <div class="error" *ngIf="firstFormGroup.get('type')?.invalid && firstFormGroup.get('type')?.touched">
          <small *ngIf="firstFormGroup.get('type')?.errors?.['required']">Type of service is required.</small>
        </div>


        <h3>Organization Name <span class="required">*</span> </h3>
        <app-custom-input formControlName="organization" placeholder="Organization Name" />
        <div class="error"
          *ngIf="firstFormGroup.get('organization')?.invalid && firstFormGroup.get('organization')?.touched">
          <small *ngIf="firstFormGroup.get('organization')?.errors?.['required']">Organization name is required.</small>
          <small *ngIf="firstFormGroup.get('organization')?.errors?.['minlength']">Minimum 2 characters
            required.</small>
        </div>

        <h3>Full Name <span class="required">*</span> </h3>
        <app-custom-input formControlName="name" placeholder="Full Name" />
        <div class="error" *ngIf="firstFormGroup.get('name')?.invalid && firstFormGroup.get('name')?.touched">
          <small *ngIf="firstFormGroup.get('name')?.errors?.['required']">Name is required.</small>
          <small *ngIf="firstFormGroup.get('name')?.errors?.['minlength']">Minimum 2 characters
            required.</small>
        </div>


        <h3>Languages <span class="required">*</span> </h3>
        <mat-form-field class="lang">
          <mat-label>Languages</mat-label>
          <mat-select multiple formControlName="language" (selectionChange)="onLanguageSelection($event)">
            <mat-select-trigger>
              {{firstFormGroup.get('language')?.value?.[0] || ''}}
              @if ((firstFormGroup.get('language')?.value?.length || 0) > 1) {
              <span class="example-additional-selection">
                (+{{(firstFormGroup.get('language')?.value?.length || 0) - 1}}
                {{firstFormGroup.get('language')?.value?.length === 2 ? 'other' : 'others'}})
              </span>
              }
            </mat-select-trigger>

            <mat-option [value]="'all'" (click)="toggleAllSelection()">
              {{ isAllSelected() ? 'âœ“ All Selected' : 'Select All' }}
            </mat-option>


            @for (language of languagesList; track language) {
            <mat-option [value]="language">{{language}}</mat-option>
            }
          </mat-select>
        </mat-form-field>

        <h3>Gender <span class="required">*</span> </h3>
        <mat-radio-group formControlName="gender">
          <mat-radio-button value="male">Male</mat-radio-button>
          <mat-radio-button value="female">Female</mat-radio-button>
          <mat-radio-button value="other">Other</mat-radio-button>
        </mat-radio-group>
        <div class="error radio" *ngIf="firstFormGroup.get('gender')?.invalid && firstFormGroup.get('gender')?.touched">
          <small *ngIf="firstFormGroup.get('gender')?.errors?.['required']">Gender is required.</small>
        </div>


        <h3>Phone <span class="required">*</span> </h3>
        <app-custom-input formControlName="mobileNo" placeholder="Phone Number" value="+91 " />
        <div class="error" *ngIf="firstFormGroup.get('mobileNo')?.invalid && firstFormGroup.get('mobileNo')?.touched">
          <small *ngIf="firstFormGroup.get('mobileNo')?.errors?.['required']">Mobile Number is required.</small>
        </div>

        <h3>Email</h3>
        <app-custom-input formControlName="email" placeholder="example@abc.com" />

        <h3>Vechile</h3>
        <app-custom-select formControlName="vechileType" [options]="[
                    {value:'', label:'None'},
                    {value:'bike', label:'Bike'},
                    {value:'car', label:'Car'},
                    {value:'cycle', label:'Cycle'},
                    {value:'other', label:'Other'}
                ]" placeholder="Select type of Work" />

        <h3>KYC Document <span class="required">*</span></h3>

        <label class="custom-file-upload">
          <mat-icon class="kyc-icon">note_add</mat-icon>
          <input type="file" formControlName="kycDocument" (change)="onKycSelected($event)" />
        </label>

        <!-- Show validation error -->
        <div class="error"
          *ngIf="firstFormGroup.get('kycDocument')?.invalid && firstFormGroup.get('kycDocument')?.touched">
          <small>KYC document is required.</small>
        </div>

        <!-- Optionally show file name -->
        <div *ngIf="selectedFileName" class="file-name">Selected: {{ selectedFileName }}</div>



        <div class="actions">
          <button mat-raised-button color="primary" (click)="nextStep()">
            Next
          </button>
        </div>
      </form>

      <!-- Step 2 -->
      <form *ngSwitchCase="1" [formGroup]="secondFormGroup">
        <h3>Additional Documents</h3>
        <p style="color: grey;">Upload related documents. This step is optional.</p>

        <label class="custom-file-upload">
          <mat-icon class="kyc-icon">note_add</mat-icon>
          <input type="file" formControlName="additionalPdfs" (change)="onAddnSelected($event)" />
        </label>
        <div class="actions">
          <button mat-button (click)="previousStep()">Previous</button>
          <button mat-raised-button color="primary" (click)="nextStep()">
            Next
          </button>
        </div>
      </form>

      <!-- Step 3 -->
      <div *ngSwitchCase="2">
  <h3>Review Details</h3>

  <div class="review-section">
    <h4>Profile Image:</h4>
    <img
      *ngIf="firstFormGroup.get('profileImage')?.value"
      alt="Profile"
      class="profile-preview"
    />
    <p *ngIf="!firstFormGroup.get('profileImage')?.value">No image uploaded</p>

    <h4>Type of Service:</h4>
    <p>{{ firstFormGroup.get('type')?.value }}</p>

    <h4>Organization Name:</h4>
    <p>{{ firstFormGroup.get('organization')?.value }}</p>

    <h4>Full Name:</h4>
    <p>{{ firstFormGroup.get('name')?.value }}</p>

    <h4>Languages:</h4>
    <p>{{ firstFormGroup.get('language')?.value?.join(', ') }}</p>

    <h4>Gender:</h4>
    <p>{{ firstFormGroup.get('gender')?.value }}</p>

    <h4>Mobile Number:</h4>
    <p>{{ firstFormGroup.get('mobileNo')?.value }}</p>

    <h4>Email:</h4>
    <p>{{ firstFormGroup.get('email')?.value }}</p>

    <h4>Vehicle Type:</h4>
    <p>{{ firstFormGroup.get('vechileType')?.value }}</p>

    <h4>KYC Document:</h4>
    <p>{{ selectedFileName || 'No file selected' }}</p>

    <h4>Additional Documents:</h4>
    <p>{{ selectedAddnName || 'No additional document uploaded' }}</p>
  </div>

  <div class="actions">
    <button mat-button (click)="previousStep()">Back</button>
    <button mat-raised-button color="accent">Submit</button>
  </div>
</div>


    </ng-container>
  </div>
</div>